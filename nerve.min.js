(function(){function t(n,t){if(!t)return null;for(var i=0,r=t.length;i<r;i++)if(t[i].callee===n)return t[i];return null}var n=[];window.nerve={on:function(i,r,u,f){var h=i,e=null,o=null,s=null;if(arguments.length==1)throw Error("A channel and a callback must be specified");else if(arguments.length==2)Object.prototype.toString.call(arguments[1])=="[object Function]"&&(o=arguments[1],s=arguments.callee);else if(arguments.length==3&&Object.prototype.toString.call(arguments[1])=="[object Function]")if(Object.prototype.toString.call(arguments[1])=="[object Function]")o=arguments[1],s=arguments[2]||arguments.callee;else throw Error("Last parameter must be a callback function");else arguments.length==4&&(h=i,e=r,o=u,s=f||arguments.callee);o&&((n[i]||(n[i]=[]),e||(e="root"),e&&!n[i][e]&&(n[i][e]=[]),t(s,n[i][e]))||n[i][e].push({callee:s,callback:o}))},off:function(t,i,r){var u,e,f,o;if(n[t]){if(u="root",e=r||arguments.callee,i&&(u=i),!n[t][u])return;for(f=0,o=n[t][u];f<o;f++)n[t][u][f].callee===e&&delete n[t][u][f]}},send:function(t,i,r){var u="root",f=null;if(arguments.length==2?f=arguments[1]:arguments.length==3&&(u=i,f=r),n[t]&&n[t][u])for(var o=n[t][u],e=0,s=o.length;e<s;e++)(function(t,i,r){var u=setTimeout(function(){n[t][i][r].callback(f),clearTimeout(u)})})(t,u,e)}}})();
